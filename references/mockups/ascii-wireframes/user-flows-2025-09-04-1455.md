# User Flow Diagrams - Interactive CLI Video Summarizer
*Created: 2025-09-04 14:55*

## Primary User Journey (Happy Path)

```
┌─────────────────┐
│ User drops      │
│ videos in       │
│ /input/         │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│ Run:            │
│ python main.py  │
└─────────┬───────┘
          │
          ▼
┌─────────────────────────────────────────────────────────────┐
│ STEP 1: INPUT VALIDATION                                    │
│ • Scan /input/ folder                                       │
│ • Display found videos with file sizes/durations           │
│ • Show total count and estimated processing time           │
│ • Prompt: "Continue with processing? (y/n):"               │
└─────────┬───────────────────────────────────────────────────┘
          │ [User types 'y']
          ▼
┌─────────────────────────────────────────────────────────────┐
│ STEP 2: PROCESSING CONFIGURATION                           │
│ • Whisper model: Large [Y/n]                               │
│ • Scene detection threshold: 0.2 [Y/n]                     │
│ • Frame extraction: High quality [Y/n]                     │
│ • Check duplicates: [Y/n]                                  │
│ • Generate log: [Y/n]                                      │
│ • Final prompt: "Start batch processing? (y/n):"          │
└─────────┬───────────────────────────────────────────────────┘
          │ [User accepts defaults or customizes]
          ▼
┌─────────────────────────────────────────────────────────────┐
│ STEP 3: BATCH PROCESSING (UNINTERRUPTED)                   │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ FOR EACH VIDEO:                                         │ │
│ │ 1. FFmpeg: Extract frames with scene detection         │ │
│ │ 2. FFmpeg: Extract audio track                         │ │
│ │ 3. Whisper: Generate transcript                        │ │
│ │ 4. Create output/{video-name}/ folder                  │ │
│ │ 5. Save transcript.txt with metadata header            │ │
│ │ 6. Save scene_*.png frames                             │ │
│ │ 7. Update progress display                             │ │
│ │ 8. Log any errors but CONTINUE processing              │ │
│ └─────────────────────────────────────────────────────────┘ │
└─────────┬───────────────────────────────────────────────────┘
          │ [All videos processed]
          ▼
┌─────────────────────────────────────────────────────────────┐
│ STEP 4: COMPLETION SUMMARY                                  │
│ • Show success/failure counts                               │
│ • Display processing time and average confidence            │
│ • List output locations                                     │
│ • Check for duplicates and flag in summary                 │
│ • Generate VIDEO_INDEX.md with all results                 │
└─────────┬───────────────────────────────────────────────────┘
          │
          ▼
┌─────────────────┐      ┌─────────────────────────────────────┐
│ Errors Found?   │ NO   │ SUCCESS: All videos processed       │
└─────────┬───────┘ ────▶│ Prompt: "Open VIDEO_INDEX.md? (y/n)"│
          │ YES          └─────────────────────────────────────┘
          ▼
┌─────────────────────────────────────────────────────────────┐
│ ERROR REVIEW (END OF BATCH ONLY)                           │
│ • List all failed videos with error details                │
│ • Show next steps for manual review                        │
│ • Offer retry option: "python main.py --retry-failed"     │
│ • Prompt: "View detailed error log? (y/n)"                │
└─────────────────────────────────────────────────────────────┘
```

## Alternative User Paths

### Path A: User Cancels During Setup
```
┌─────────────────┐
│ INPUT VALIDATION│
│ "Continue? (y/n)"│
└─────────┬───────┘
          │ [User types 'n']
          ▼
┌─────────────────┐
│ GRACEFUL EXIT   │
│ "Processing     │
│ cancelled.      │
│ No changes made"│
└─────────────────┘
```

### Path B: User Cancels During Configuration  
```
┌─────────────────┐
│ CONFIGURATION   │
│ "Start batch    │
│ processing?(y/n)"│
└─────────┬───────┘
          │ [User types 'n']
          ▼
┌─────────────────┐
│ RETURN TO START │
│ "Configuration  │
│ cancelled.      │
│ Run again when  │
│ ready."         │
└─────────────────┘
```

### Path C: No Videos Found
```
┌─────────────────┐
│ INPUT VALIDATION│
│ Scan /input/    │
└─────────┬───────┘
          │ [0 videos found]
          ▼
┌─────────────────────────────────────┐
│ EMPTY INPUT FOLDER                  │
│ "No video files found in /input/"  │
│ "Supported: .mp4, .mov, .avi, .mkv"│
│ "Add videos and run again."         │
└─────────────────────────────────────┘
```

## Error Recovery Flows

### Flow 1: Disk Space Issues During Processing
```
┌─────────────────┐
│ Processing      │
│ Video #15       │
└─────────┬───────┘
          │ [Disk space error]
          ▼
┌─────────────────────────────────────┐
│ LOG ERROR & CONTINUE                │
│ • Log: "Insufficient disk space"   │
│ • Skip current video               │
│ • Update progress: "15/39 (1 failed)"│
│ • Continue with video #16          │
└─────────┬───────────────────────────┘
          │ [Continue batch]
          ▼
┌─────────────────────────────────────┐
│ END-OF-BATCH ERROR REVIEW          │
│ "1 video failed due to disk space" │
│ "Free up space and retry"          │
└─────────────────────────────────────┘
```

### Flow 2: Corrupted Video File
```
┌─────────────────┐
│ FFmpeg Frame    │
│ Extraction      │
└─────────┬───────┘
          │ [FFmpeg fails]
          ▼
┌─────────────────────────────────────┐
│ LOG ERROR & CONTINUE                │
│ • Log: "Corrupted video file"      │
│ • Skip to next video               │
│ • No partial output created        │
│ • Update error counter             │
└─────────┬───────────────────────────┘
          │ [Continue batch]
          ▼
┌─────────────────────────────────────┐
│ END-OF-BATCH ERROR REVIEW          │
│ "File appears corrupted"           │
│ "Check source video manually"      │
└─────────────────────────────────────┘
```

### Flow 3: Whisper Transcription Failure
```
┌─────────────────┐
│ Whisper         │
│ Transcription   │
└─────────┬───────┘
          │ [Whisper fails]
          ▼
┌─────────────────────────────────────┐
│ PARTIAL SUCCESS HANDLING           │
│ • Frames extracted successfully    │
│ • Audio extraction successful      │
│ • Transcription failed             │
│ • Create folder with frames only   │
│ • Log transcription failure        │
└─────────┬───────────────────────────┘
          │ [Continue batch]
          ▼
┌─────────────────────────────────────┐
│ END-OF-BATCH ERROR REVIEW          │
│ "Frames available, transcript      │
│ failed. Retry transcription only?" │
└─────────────────────────────────────┘
```

## Edge Case Handling

### Edge Case 1: Extremely Large Video
```
┌─────────────────┐
│ Large Video     │
│ (>2GB, >2 hours)│
└─────────┬───────┘
          │
          ▼
┌─────────────────────────────────────┐
│ EXTENDED PROCESSING HANDLING        │
│ • Show warning: "Large video detected"│
│ • Estimated time: "45+ minutes"    │
│ • Progress updates every 30 seconds │
│ • Memory monitoring active          │
│ • Temp file cleanup during process │
└─────────┬───────────────────────────┘
          │ [Normal completion]
          ▼
┌─────────────────┐
│ Success with    │
│ extended time   │
│ noted in log    │
└─────────────────┘
```

### Edge Case 2: Audio-Only File
```
┌─────────────────┐
│ FFmpeg Frame    │
│ Extraction      │
└─────────┬───────┘
          │ [No video stream]
          ▼
┌─────────────────────────────────────┐
│ AUDIO-ONLY HANDLING                │
│ • Skip frame extraction            │
│ • Proceed with audio transcription │
│ • Create folder with transcript    │
│ • Note "Audio-only" in metadata    │
└─────────┬───────────────────────────┘
          │
          ▼
┌─────────────────┐
│ Partial success:│
│ transcript only │
│ (no frames)     │
└─────────────────┘
```

### Edge Case 3: Duplicate Detection During Processing
```
┌─────────────────┐
│ Processing      │
│ Video #23       │
└─────────┬───────┘
          │
          ▼
┌─────────────────────────────────────┐
│ DUPLICATE CHECK                     │
│ • Compare filename patterns        │
│ • Compare video duration           │
│ • Compare file size                │
│ • Flag if 75%+ similarity         │
└─────────┬───────────────────────────┘
          │ [Potential duplicate]
          ▼
┌─────────────────────────────────────┐
│ PROCESS BUT FLAG                    │
│ • Complete normal processing       │
│ • Add duplicate flag to metadata   │
│ • Mark in VIDEO_INDEX.md with 🔄   │
│ • Include in end summary           │
└─────────────────────────────────────┘
```

## Administrative Workflows

### Workflow A: Retry Failed Videos Only
```
┌─────────────────┐
│ User runs:      │
│ python main.py  │
│ --retry-failed  │
└─────────┬───────┘
          │
          ▼
┌─────────────────────────────────────┐
│ READ PREVIOUS ERROR LOG             │
│ • Parse processing.log              │
│ • Identify failed video files      │
│ • Skip successfully processed ones  │
└─────────┬───────────────────────────┘
          │
          ▼
┌─────────────────────────────────────┐
│ RETRY-ONLY BATCH PROCESSING         │
│ • Show: "Retrying 3 failed videos" │
│ • Process only failed files        │
│ • Update existing VIDEO_INDEX.md   │
│ • Merge results with previous run  │
└─────────────────────────────────────┘
```

### Workflow B: View Processing History
```
┌─────────────────┐
│ User runs:      │
│ python main.py  │
│ --history       │
└─────────┬───────┘
          │
          ▼
┌─────────────────────────────────────┐
│ DISPLAY PROCESSING HISTORY          │
│ • Show last 10 processing runs     │
│ • Success/failure counts per run   │
│ • Processing times and dates       │
│ • Option to view specific logs     │
└─────────────────────────────────────┘
```

### Workflow C: Clean Restart
```
┌─────────────────┐
│ User runs:      │
│ python main.py  │
│ --clean-restart │
└─────────┬───────┘
          │
          ▼
┌─────────────────────────────────────┐
│ CLEAN EXISTING OUTPUT               │
│ • Backup existing VIDEO_INDEX.md   │
│ • Clear /output/ folder             │
│ • Reset processing logs             │
│ • Confirm: "Delete existing results?"│
└─────────┬───────────────────────────┘
          │ [User confirms]
          ▼
┌─────────────────┐
│ FRESH BATCH     │
│ PROCESSING      │
│ (Normal flow)   │
└─────────────────┘
```

---

## Flow Summary

**Primary Flow**: Setup → Configure → Uninterrupted Processing → Results Review  
**Error Philosophy**: Log and continue, review at end  
**User Intervention**: Only at start/end, never during processing  
**Recovery Options**: Retry failed files only, view logs, clean restart

**Key Design Principles:**
1. **Non-interrupting**: Batch processes completely without user input
2. **Error Resilient**: Individual failures don't stop entire batch  
3. **Transparent**: Clear progress and error logging throughout
4. **Recovery Friendly**: Easy retry mechanisms for failed items
5. **Marketing Team Friendly**: Simple start, walk away, review results